%% ==============================================================================
%% Intent Abstraction Funnel Diagram
%% ==============================================================================
%% Source File:     specs/unl/intent-mapping.md
%% Repository Path: diagrams/unl/flows/unl-intent-abstraction.png
%% Description:     Visualizes the narrowing of meaning from Natural Expression
%%                  (Tier 1) to Semantic Frame (Tier 2) to Praxeological Intent
%%                  (Tier 3).
%% ==============================================================================

graph TD
    %% Global Styles
    classDef tier1 fill:#e3f2fd,stroke:#1565c0,stroke-width:2px,color:#000;
    classDef tier2 fill:#bbdefb,stroke:#1565c0,stroke-width:2px,color:#000;
    classDef tier3 fill:#90caf9,stroke:#0d47a1,stroke-width:2px,color:#000;
    classDef core fill:#f3e5f5,stroke:#4a148c,stroke-width:2px,color:#000;
    classDef meta fill:#fff9c4,stroke:#fbc02d,stroke-width:1px,stroke-dasharray: 5 5,color:#000;

    %% 1. Top of Funnel: Natural Expression
    subgraph "Tier 1: Natural Expression (Human)"
        direction TB
        L1[Raw Multimodal Input]:::tier1
        Ex1["Example: 'Kill the pump!' + [Gesture]"]:::tier1
        
        L1 --- Ex1
    end

    %% Process 1
    Parse(Semantic Parsing & Normalization):::meta
    L1 --> Parse
    Parse --> L2

    %% 2. Middle of Funnel: Semantic Frame
    subgraph "Tier 2: Semantic Frame (Neutral)"
        direction TB
        L2[Abstract Representation]:::tier2
        Ex2["{ entities: ['pump_04'], action: 'shutdown' }"]:::tier2
        
        L2 --- Ex2
    end

    %% Process 2
    Map(Contextual Binding & Mapping):::meta
    L2 --> Map
    Map --> L3

    %% 3. Bottom of Funnel: Praxeological Intent
    subgraph "Tier 3: Praxeological Intent (Machine)"
        direction TB
        L3[UNLIntent Structure]:::tier3
        Ex3["[ Entity: Pump-401 | Action: STOP | State: ISOLATED ]"]:::tier3
        
        L3 --- Ex3
    end

    %% Destination
    CC[Cognitive Core]:::core
    
    L3 -->|Deterministic Logic| CC

    %% Ambiguity Levels (Side Notes)
    Amb1["Ambiguity: HIGH<br/>Context: Implicit"]:::meta -.-> L1
    Amb2["Ambiguity: LOW<br/>Context: Neutral"]:::meta -.-> L2
    Amb3["Ambiguity: ZERO<br/>Context: Explicit"]:::meta -.-> L3
