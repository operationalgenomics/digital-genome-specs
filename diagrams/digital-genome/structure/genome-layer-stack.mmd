%% ==============================================================================
%% Genome Layer Stack Diagram
%% ==============================================================================
%% Source File:     specs/digital-genome/structure-definition.md
%% Repository Path: diagrams/digital-genome/structure/genome-layer-stack.png
%% Description:     Visualizes the four-layer stack of the Digital Genome: 
%%                  Header (Metadata), Ontology (Definitions), Praxeology 
%%                  (Logic/Genes), and Binding (Physical Map).
%% ==============================================================================

graph TD
    %% Global Styles
    classDef header fill:#37474f,stroke:#263238,stroke-width:2px,color:#fff;
    classDef ontology fill:#e1f5fe,stroke:#01579b,stroke-width:2px,color:#000;
    classDef logic fill:#fff9c4,stroke:#fbc02d,stroke-width:2px,color:#000;
    classDef binding fill:#e8f5e9,stroke:#1b5e20,stroke-width:2px,color:#000;
    classDef ext fill:#eeeeee,stroke:#212121,stroke-width:2px,stroke-dasharray: 5 5,color:#000;

    %% Layer 1: Header (Metadata)
    subgraph L1 ["1. Header Layer (Metadata)"]
        direction TB
        ID[Genome ID]:::header
        Ver[Version Control]:::header
        Sig[Cryptographic Hash]:::header
    end

    %% Layer 2: Ontology (Definitions)
    subgraph L2 ["2. Ontology Layer (Semantics)"]
        direction TB
        EntDef[Entity Definitions]:::ontology
        RelDef[Relation Schema]:::ontology
        StateDef[State Dictionary]:::ontology
        
        EntDef --- RelDef
        RelDef --- StateDef
    end

    %% Layer 3: Praxeology (Logic)
    subgraph L3 ["3. Praxeology Layer (Logic)"]
        direction TB
        GenePool[Gene Pool]:::logic
        Codons[Codon Library]:::logic
        Rules[Invariant Rules]:::logic
        
        GenePool --> Codons
        Codons --- Rules
    end

    %% Layer 4: Binding (Physical)
    subgraph L4 ["4. Binding Layer (Execution)"]
        direction TB
        Map[Entity-to-ID Map]:::binding
        Params[Parameter Configuration]:::binding
        Endpoints[API Endpoints]:::binding
    end

    %% Relationships
    L1 --> L2
    L2 --> L3
    L3 --> L4

    %% External Interface
    Context[Cognitive Core]:::ext
    L4 -.->|Exposes| Context

    %% Annotations
    note1["Defines 'What Exists'"]:::ontology -.-> L2
    note2["Defines 'What to Do'"]:::logic -.-> L3
    note3["Defines 'Where it is'"]:::binding -.-> L4
