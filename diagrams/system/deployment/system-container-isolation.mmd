%% ==============================================================================
%% Container Isolation Diagram
%% ==============================================================================
%% Source File:     specs/system/deployment-model.md
%% Repository Path: diagrams/system/deployment/system-container-isolation.png
%% Description:     Visualizes the containerization strategy, showing hardened
%%                  boundaries, resource isolation, and safety sandboxes for
%%                  critical components.
%% ==============================================================================

graph TD
    %% Global Styles
    classDef container fill:#e3f2fd,stroke:#1565c0,stroke-width:2px,color:#000;
    classDef sandbox fill:#e8f5e9,stroke:#1b5e20,stroke-width:3px,stroke-dasharray: 5 5,color:#000;
    classDef resource fill:#fff9c4,stroke:#fbc02d,stroke-width:1px,color:#000;
    classDef gov fill:#fbe9e7,stroke:#bf360c,stroke-width:2px,color:#000;
    classDef net fill:#eceff1,stroke:#455a64,stroke-width:1px,stroke-dasharray: 2 2,color:#000;

    %% 1. Cognitive Zone (Cloud/HPC)
    subgraph CognitiveZone ["Cognitive Isolation Zone (Heavy Compute)"]
        direction TB
        
        subgraph C_Core ["Core Container"]
            CC[Cognitive Core]:::container
            Res1[Resource Limit: GPU/CPU]:::resource
        end
        
        subgraph C_Sim ["Simulation Sandbox"]
            Sim[Simulation Engine]:::container
            Res2[Resource Limit: High Memory]:::resource
        end
        
        C_Core <-->|Authenticated API| C_Sim
    end

    %% 2. Execution Zone (Edge/Real-Time)
    subgraph ExecutionZone ["Execution Isolation Zone (Real-Time)"]
        direction TB
        
        subgraph C_UNL ["Interface Container"]
            UNL[UNL Service]:::container
        end
        
        subgraph C_Safe ["Safety Critical Sandbox"]
            Gateway[Execution Gateway]:::sandbox
            Emerg[Emergency Logic]:::sandbox
            Res3[Resource Guarantee: Real-Time]:::resource
        end
        
        subgraph C_Act ["Adaptor Container"]
            Adaptor[Actuation Adaptor]:::container
        end
        
        UNL -->|Intent| Gateway
        Gateway -->|Validated Cmd| Adaptor
    end

    %% 3. Governance Zone (Immutable)
    subgraph GovZone ["Governance & Audit Zone"]
        direction TB
        subgraph C_Ledger ["Ledger Container"]
            Ledger[Governance Ledger]:::gov
            Store[Immutable Storage]:::gov
        end
    end

    %% 4. Monitoring Zone (Observer)
    subgraph MonZone ["Monitoring Zone"]
        direction TB
        subgraph C_Mon ["Telemetry Container"]
            Mon[Monitoring Agent]:::container
        end
    end

    %% Cross-Zone Communication (Zero Trust)
    CC <-->|Encrypted Channel| Gateway
    Gateway -.->|Audit Logs| Ledger
    Adaptor -.->|Telemetry| Mon
    Mon -.->|Feedback| CC

    %% Boundaries (Represented by labeled links)
    CognitiveZone -.->|BOUNDARY: Hard Resource Wall| ExecutionZone
    ExecutionZone -.->|BOUNDARY: Network Segmentation| GovZone

    %% Annotations
    note1["Sandboxes prevent runaway processes<br/>from starving critical safety logic"]:::resource -.-> C_Safe
    note2["Zero-Trust: All cross-container<br/>calls require mutual TLS"]:::net -.-> C_Core
